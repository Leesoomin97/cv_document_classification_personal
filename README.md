# 🗂️ Document Type Classification -- 개인 실험 레포 (Main Branch)

이 레포지토리는 **문서 타입 이미지 분류 대회**에서\
제가 수행한 실험들 중, **정제된 결과물만 선별하여 정리한 저장소입니다.

대회의 목표는 **문서 이미지(총 17종)를 입력받아 해당 클래스를 예측하는
모델을 구축하는 것**이며,\
평가지표는 **Macro F1 Score** 입니다.

> ⚠️ 이 README는 **Main 브랜치 기준**입니다.\
> 상세 실험 데이터 및 시행착오는 모두 `dev` 브랜치에 있습니다.

------------------------------------------------------------------------

# 📁 Repository Structure (Main Branch 기준)

    cv_document_classification_personal/
    │
    ├── baseline/
    │   ├── baseline_code_1.ipynb
    │   ├── baseline_code_2.ipynb
    │   ├── baseline_code_3.ipynb
    │   ├── baseline_code_4.ipynb
    │   ├── baseline_code_5.ipynb
    │   ├── baseline_code_6.ipynb
    │   └── baseline_code_7.ipynb
    │
    ├── data/                      # 데이터 경로 구조만 유지 (파일은 없음)
    │   ├── raw/
    │   ├── interim/
    │   └── processed/
    │
    ├── eda_preprocessing/
    │   ├── offline_argumentation_v3.ipynb
    │   └── processing_final_v9.ipynb
    │
    ├── modeling/
    │   └── v12_b4_b5_ensemble.ipynb   # 개인 최고점(0.9318) 버전
    │
    ├── results/
    │   ├── submission_example.csv
    │   └── metrics_summary.md
    │
    ├── .gitignore
    ├── README.md
    └── requirements.txt

------------------------------------------------------------------------

# 🔍 프로젝트 개요

이번 문서 분류 대회는 실제 현업 문서 이미지를 기반으로 구성되어 있어,\
**다양한 노이즈·손상·촬영 조건이 섞여 있는 고난도 CV 이미지 분류
문제**였습니다.

-   Train 이미지: **1,570장**
-   Test 이미지: **3,140장**
-   클래스 수: **17개**
-   평가 지표: **Macro F1 Score**

문서의 종류가 다양하고, 의료·보험·차량 문서 등 특정 클래스는\
서로 유사도가 매우 높아 분류 난도가 높았습니다.

------------------------------------------------------------------------

# 🧪 실험 과정 요약 (버전별 변화 과정)

실험은 총 **Ver.1 \~ Ver.14**, 총 14단계로 구성되었습니다.\
각 단계는 전처리·백본 선택·전략 변화에 따라 성능이 크게 달라졌습니다.

## 📈 버전별 흐름 요약

  -------------------------------------------------------------------------------------------------
  단계           버전 구간    주요 시도 내용  한계 / 문제  전환점 / 개선            결과 / 배운 점
  -------------- ------------ --------------- ------------ ------------------------ ---------------
  **초반**       Ver.1--3     Swin-Tiny 기반, 성능 0.8     EfficientNet(B3·B4·B5)   백본 구조
                              전처리만        중반에서     계열로 전환              선택의 중요성
                              변경하며 시도   정체                                  인식

  **혼란기**     Ver.4--9     EfficientNet    OCR/ViT 추가 OCR 완전 제거,           부가 피처가
                              앙상블 →        직후 0.1대   Vision-only로 회귀       항상 이득은
                              OCR·ViT 융합    점수 폭락,                            아님
                              시도            GPU 세션                              
                                              중단                                  

  **전환점**     Ver.10--11   **전처리 방향   전처리 후    오프라인 증강 → 전처리 → 데이터 품질과
                              재정리:**       증강         학습 순으로 재구성       순서가 모델보다
                              기하학 중심 →   적용하여                              중요
                              **재질·노이즈   노이즈 심화                           
                              중심**                                                
                              `<br>`{=html}                                         
                              (Gaussian Blur,                                       
                              White Balance,                                        
                              CLAHE 등)                                             

  **성장기**     Ver.12--13   B4 메인 + B5    Semantic     17개 클래스 그대로       개인 최고점
                              서브 앙상블.    그룹 분류는  학습 + 오버샘플링        **0.9318** 달성
                              클래스 불균형   오히려 성능                           
                              보정, 3·7·14    저하                                  
                              별도 보정                                             

  **최종단계**   Ver.14       B4 seed         과도한 TTA로 TTA 강도 조절 및 최적    0.9 초반대
                              앙상블 + B5     시간 증가 +  조합 확립                안정된 성능
                              서브 조합, TTA  점수 출렁임                           
                              튜닝                                                  
  -------------------------------------------------------------------------------------------------

------------------------------------------------------------------------

# 🧼 전처리 전략 (Main 기준)

Main 브랜치에는 최종적으로 성능 향상에 기여한 전처리만 포함되어
있습니다.

### ❌ 성능이 떨어졌던 초기 전략

-   회전·전치·플립 등 **기하학적 변형 중심**
-   OCR 기반 피처 사용 → 실제 test 이미지 품질이 낮아 오히려 성능 폭락
-   전처리 후 오프라인 증강 적용 → 과노이즈 유발

### ✅ 최종 성능 향상에 후기 전략

-   **문서 재질 기반 전처리**
    -   Gaussian Blur 기반 배경 평탄화
    -   White Balance(Gray World)
    -   CLAHE(L 채널 대비 증가)
-   **올바른 증강 순서 확립**
    -   오프라인 증강 → 전처리 → 학습
-   **클래스 불균형 보정 (Oversampling)**
-   **병원 관련 문서로서 문서별 구분 어려운 클래스(3,7,14)를 따로 서브 모델로 앙상블함**

------------------------------------------------------------------------

# 🧠 모델링 전략 (Main 기준)

Main 브랜치에는 실제 성능을 크게 향상시킨 조합만 남겼습니다.

### ✔ 백본 모델

-   EfficientNet-B4 --- **메인 모델**
-   EfficientNet-B5 --- **3·7·14 보정용 서브 모델**

### ✔ 핵심 기법

-   2-Stage Ensemble (Main → Sub 보정)
-   Oversampling
-   적정 수준의 TTA만 적용 (과도한 TTA는 배제)

### ✔ 최고 성능

-   **Macro F1 Score: 0.9318** (Ver.12)

------------------------------------------------------------------------

# 🌿 Branch Structure

## 🔵 `main` --- 정식 공개용 브랜치 (Stable)

-   baseline 1\~7\
-   최종 전처리(v9)\
-   최고 성능 모델(v12)\
-   발표/포트폴리오 공유용으로 정리된 구조

## 🟣 `dev` --- 실험 및 연구 브랜치 (Experimental)

-   Ver.1\~14의 **모든 시도 기록**\
-   실패한 전처리, 증강 기법 기록\
-   OCR·ViT·ConvNeXt·Swin 등 실패한 실험 포함\
-   WandB 기반 실험 로그\
-   다양한 전처리 실험 버전 및 중간 모델\
-   실제 탐색 과정 전체 히스토리 보존

------------------------------------------------------------------------

# 📦 Requirements

필요 패키지는 `requirements.txt` 에 정리되어 있습니다.\
(timm, albumentations, opencv-python, torch, torchvision 등)

------------------------------------------------------------------------

# 📌 Contact

궁금한 점 또는 코드 관련 문의는 이슈로 남겨주세요.
